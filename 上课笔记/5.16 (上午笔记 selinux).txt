5.16 (上午笔记 selinux)

'selinux'
	Security-Enhanced Linux ：安全增强的Linux

	软件的安全性：
		1、选择安全系数较高的系统
		2、提高现有系统的安全性

	计算机的安全等级：
		A：最高等级
			只有A1,这一级别，A级别称为'验证设计级（Verity Design）'，是目前最高的安全级别，
			在A级别中，安全的设计必须给出形式化设计说明和验证，需要有严格的数学推导过程，同时应该包含秘密信道和可信分布的分析，
			也就是说要保证系统的部件来源有安全保证，例如对这些软件和硬件在生产、销售、运输中进行严密跟踪和严格的配置管理，以避免出现安全隐患
		
		B：B级别包括B1、B2和B3三个级别，B级别能够提供强制性安全保护和多级安全。强制防护是指定义及保持标记的完整性，信息资源的拥有者不具有更改自身的权限，系统数据完全处于访问控制管理的监督下。
			B1级称为标识安全保护（Labeled Security Protection）。
			B2级称为结构保护级别（Security Protection），要求访问控制的所有对象都有安全标签以实现低级别的用户不能访问敏感信息，对于设备、端口等也应标注安全级别。
			B3级别称为安全域保护级别（Security Domain），这个级别使用安装硬件的方式来加强域的安全，比如用内存管理硬件来防止无授权访问。
		
		C：C级别有两个子系统，C1级和C2。
			C1级称为选择性保护级（Discrtionary Security Protection）可以实现自主安全防护，对用户和数据的分离，保护或限制用户权限的传播。
			C2级具有访问控制环境的权力，比C1的访问控制划分的更为详细，能够实现受控安全保护、个人帐户管理、审计和资源隔离。
			'这个级别的系统包括UNIX、LINUX和WindowsNT系统。'（C2级别）
			
			C级别属于自由选择性安全保护，在设计上有自我保护和审计功能，可对主体行为进行审计与约束。C级别的安全策略主要是自主存取控制，可以实现

		D：级别是最低的安全级别，对系统提供最小的安全防护。
			系统的访问控制没有限制，无需登陆系统就可以访问数据，这个级别的系统包括DOS，WINDOWS98等。


	'访问控制：'
		基本要素：
			1、主体：主动的实体，用户、服务、进程等（访问者：用户）
			2、客体：被动的实体，包括：数据、文件等
			3、规则：主体对客体访问的策略集合

		类型：
			'DAC访问控制：'自主访问控制；通过权限列表（访问控制列表）来限定特定主体对特定客体可以执行什么操作
				特点：
					1、每个主体都拥有一个用户名或组来获取操作权限
					2、每个客体都拥有一个限定主体对其访问的访问控制列表
					3、访问时，基于访问控制列表检查主体用户标识以实现授权或拒绝
			
				进程的访问权限
					进程拥有超过其本该拥有的权限
				管理员的访问权限：
					管理员拥有超过其本该拥有的权限
				普通用户的访问权限


			'MAC访问控制：'强制访问控制
				特点：
					1、主体被分配一个安全等级
					2、客体被分配一个安全等级
					3、访问时，对主体和客体的安全级别进行对比，最终获得授权或拒绝


			SandBox沙盒：虚拟化技术

			折中方案：将部分服务或进程纳入到MAC的访问控制范围内即可。

			对跨网络访问的服务或进程启用MAC访问控制机制



'selinux：'  33分钟视频
	配置文件：
		/etc/selinux/config 

	'工作级别'：
		strict：严格模式，每个进程都会受到selinux的控制
		targeted：宽松模式，仅对部分进程启用selinux的控制

	启动状态：
		enforcing：强制开启
		permissive：警告级别，不阻止访问，但会记录日志
		disabled：禁用


	临时设置：
		getenforce 查看当前selinux状态
		setenforce 0 | 1
			0 关闭selinux
			1 启动selinux


	selinux的格式：
		1、subject
			进程、服务（主体）
		2、operation
			操作
				open close read write chown chmod 
		3、object
			进程、文件。被访问者，（客体）

	生效条件：
		1、SElinux是否生效，取决于subject和object是否处于同一个操作空间（sandbox）
		2、 操作类型必须满足条件


	'安全标签：（`ls -Zl`查看）'
		用户:角色:类型
			一般只看'类型'


	查看与配置（安全标签）：

		查看： 
			查看文件安全标签：
				ls -lZ 
			查看进程安全标签：
				ps auxZ

			查看所有文件的默认标签：
				$ semanage fcontext -l


		修改标签：
				'chcon命令'：
					修改文件安全标签
						选项：
							-u：修改用户
							-r：修改角色
							-t：修改类型(域)
							-R：递归修改

				'restorecon命令：'
					还原文件的初始安全标签
						选项：
							-R：递归还原

						$ restorecon FILE_NAME

		修改SElinux的布尔值：
			添加或删除进程/服务本身开启的功能模块

				'getsebool命令'
					查看进程的布尔值
						选项：
							-a：查看所有
						$ getsebool MODULE
					或者
					semanage boolean -l 也可以查看


				'setsebool命令：'
					修改进程的布尔值
						选项：
							-P：写入磁盘的文件内
						$ setsebool MODULE

		日志文件：
			/var/log/audit/audit.log


'端口号：'
	常用服务端口：
		/etc/services

	查看端口：
		semanage port -l

	增加端口：
		semanage port -a -t http_port_t -p tcp portnumber
			-a：增加端口
			-t：指定类型
			-p：指定传输类型  tcp |  udp
			最后跟端口号
			-d：删除











